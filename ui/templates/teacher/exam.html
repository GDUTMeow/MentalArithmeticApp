<!-- 考试管理 -->
<div class="container" id="exam-management-teacher" style="display: none">
    <div class="card">
        <div class="card-body">
            <!-- 管理按钮 -->
            <div class="row">
                <div class="col-md-12 d-flex justify-content-between">
                    <div class="col-md-3">
                        <button type="button" class="btn btn-success btn-rounded btn-lg" style="width: 95%" data-mdb-ripple-color="#ffffff" onclick="showExamAddPrompt()">
                            新建考试
                        </button>
                    </div>
                    <div class="col-md-3">
                        <button type="button" class="btn btn-danger btn-rounded btn-lg" style="width: 95%" data-mdb-ripple-color="#ffffff" onclick="deleteSelectedExams()">
                            删除考试
                        </button>
                    </div>
                    <div class="col-md-3">
                        <button type="button" class="btn btn-warning btn-rounded btn-lg" style="width: 95%" data-mdb-ripple-color="#ffffff" onclick="showExamModifyPrompt()">
                            修改考试
                        </button>
                    </div>
                    <div class="col-md-3">
                        <button type="button" class="btn btn-info btn-rounded btn-lg" style="width: 95%" data-mdb-ripple-color="#ffffff" onclick="viewExamScores()">
                            查看成绩
                        </button>
                    </div>
                </div>
            </div>
            <br />
            <div class="table-responsive">
                <table class="table table-striped table-hover" id="exam-table">
                    <thead>
                        <tr>
                            <th scope="col">
                                <input type="checkbox" id="select-all" onclick="toggleSelectAll(this)" />
                            </th>
                            <th scope="col">#</th>
                            <th scope="col">考试名称</th>
                            <th scope="col">当前状态</th>
                            <th scope="col">开始时间</th>
                            <th scope="col">结束时间</th>
                            <th scope="col">允许逾期作答</th>
                            <th scope="col">随机问题顺序</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% set exams = exams|default({"data": [{"id": "UUID4", "name": "测试考试", "current_status": -1, "start_time": 1704628540, "end_time": "1704635143", "allow_answer_when_expired": 1, "random_question": 0}]}) %} {% for item in exams.data %}
                        <tr>
                            <td>
                                <input type="checkbox" class="exam-select" value="{{ item.id }}" />
                            </td>
                            <th scope="row">{{ loop.index }}</th>
                            <td>{{ item.name }}</td>
                            <td>
                                {% if item.current_status == 0 %}未开始{% elif item.current_status == 1 %}正在进行{% elif item.current_status == -1 %}已结束{% else %}未知状态{% endif %}
                            </td>
                            <td>{{ item.start_time }}</td>
                            <td>{{ item.end_time }}</td>
                            <td>
                                {% if item.allow_answer_when_expired %}是{% else %}否{% endif %}
                            </td>
                            <td>{% if item.random_question %}是{% else %}否{% endif %}</td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>

<!-- 考试添加框 -->
<div class="container" id="exam-add-prompt" style="display: none">
    <div class="row">
        <div class="col-12">
            <div class="card">
                <div class="card-body">
                    <div class="col-3 mb-3">
                        <button type="button" class="btn btn-secondary btn-rounded btn-lg w-100" data-mdb-ripple-color="#ffffff" id="return-to-exam-management" onclick="returnToExamManagement()">
                            返回
                        </button>
                    </div>
                    <section class="mb-4">
                        <!-- Section heading -->
                        <h2 class="h1-responsive font-weight-bold text-center my-4">
                            添加考试
                        </h2>
                        <!-- Section description -->
                        <p class="text-center w-responsive mx-auto mb-5">
                            请在下方输入考试的相关信息
                        </p>
                        <!-- 考试名称 -->
                        <div class="form-floating mb-3">
                            <input type="text" id="exam-add-name" class="form-control" placeholder="考试名称" />
                            <label for="exam-name">考试名称</label>
                        </div>
                        <!-- 考试起始日期和时间 -->
                        <div class="row">
                            <div class="col-md-3 mb-3">
                                <div class="form-floating">
                                    <input type="date" id="exam-add-start-date" class="form-control" placeholder="考试起始日期" />
                                    <label for="exam-start-date">考试起始日期</label>
                                </div>
                            </div>
                            <div class="col-md-3 mb-3">
                                <div class="form-floating">
                                    <input type="time" id="exam-add-start-time" class="form-control" placeholder="考试起始时间" />
                                    <label for="exam-start-time">考试起始时间</label>
                                </div>
                            </div>
                            <!-- 考试结束日期和时间 -->
                            <div class="col-md-3 mb-3">
                                <div class="form-floating">
                                    <input type="date" id="exam-add-end-date" class="form-control" placeholder="考试结束日期" />
                                    <label for="exam-end-date">考试结束日期</label>
                                </div>
                            </div>
                            <div class="col-md-3 mb-3">
                                <div class="form-floating">
                                    <input type="time" id="exam-add-end-time" class="form-control" placeholder="考试结束时间" />
                                    <label for="exam-end-time">考试结束时间</label>
                                </div>
                            </div>
                        </div>
                        <!-- 允许逾期作答和随机问题顺序 -->
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <div class="form-floating">
                                    <select id="exam-add-allow-answer-when-expired" class="form-select" aria-label="允许逾期作答">
                                        <option value="" selected>--- 请选择 ---</option>
                                        <option value="1">允许</option>
                                        <option value="0">不允许</option>
                                    </select>
                                    <label for="allow-answer-when-expired">允许逾期作答</label>
                                </div>
                            </div>
                            <div class="col-md-6 mb-3">
                                <div class="form-floating">
                                    <select id="exam-add-random-questions" class="form-select" aria-label="随机问题顺序">
                                        <option value="" selected>--- 请选择 ---</option>
                                        <option value="1">是</option>
                                        <option value="0">否</option>
                                    </select>
                                    <label for="random-questions">随机问题顺序</label>
                                </div>
                            </div>
                        </div>
                        <!-- 导入题目文件 -->
                        <div class="col-12 mb-3">
                            <span id="xlsx-file-name">请选择要导入的题目文件（csv格式）</span>
                            <br />
                            <div class="row mt-2">
                                <div class="col-md-6 mb-3">
                                    <button type="button" class="btn btn-info btn-rounded btn-lg w-100" data-mdb-ripple-color="#ffffff" id="exam-download-template" onclick="">
                                        下载题目模板
                                    </button>
                                </div>
                            </div>
                            <div class="row mt-2">
                                <div class="col-md-6 mb-3">
                                    <input type="file" id="xlsx-file" style="display: none" accept=".xlsx" />
                                    <button type="button" class="btn btn-primary btn-rounded btn-lg w-100" data-mdb-ripple-color="#ffffff" id="exam-add-import-questions" onclick="importXlsxFile()">
                                        导入题目
                                    </button>
                                </div>
                                <div class="col-md-6 mb-3">
                                    <button type="button" class="btn btn-success btn-rounded btn-lg w-100" data-mdb-ripple-color="#ffffff" id="exam-add-confirm" disabled onclick="addExam()">
                                        确定导入
                                    </button>
                                </div>
                            </div>
                        </div>
                    </section>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- 考试修改框 -->
<div class="container" id="exam-modify-prompt" style="display: none">
    <div class="row">
        <div class="col-12">
            <div class="card">
                <div class="card-body">
                    <div class="col-3 mb-3">
                        <button type="button" class="btn btn-secondary btn-rounded btn-lg w-100" data-mdb-ripple-color="#ffffff" id="return-to-exam-management" onclick="returnToExamManagement()">
                            返回
                        </button>
                    </div>
                    <section class="mb-4">
                        <!-- Section heading -->
                        <h2 class="h1-responsive font-weight-bold text-center my-4">
                            修改考试
                        </h2>
                        <!-- Section description -->
                        <p class="text-center w-responsive mx-auto mb-5">
                            请在下方修改考试的相关信息
                        </p>
                        <!-- 考试名称 -->
                        <div class="form-floating mb-3">
                            <input type="text" id="modify-exam-name" class="form-control" placeholder="考试名称" />
                            <label for="modify-exam-name">考试名称</label>
                        </div>
                        <!-- 考试起始日期和时间 -->
                        <div class="row">
                            <div class="col-md-3 mb-3">
                                <div class="form-floating">
                                    <input type="date" id="modify-exam-start-date" class="form-control" placeholder="考试起始日期" />
                                    <label for="modify-exam-start-date">考试起始日期</label>
                                </div>
                            </div>
                            <div class="col-md-3 mb-3">
                                <div class="form-floating">
                                    <input type="time" id="modify-exam-start-time" class="form-control" placeholder="考试起始时间" />
                                    <label for="modify-exam-start-time">考试起始时间</label>
                                </div>
                            </div>
                            <!-- 考试结束日期和时间 -->
                            <div class="col-md-3 mb-3">
                                <div class="form-floating">
                                    <input type="date" id="modify-exam-end-date" class="form-control" placeholder="考试结束日期" />
                                    <label for="modify-exam-end-date">考试结束日期</label>
                                </div>
                            </div>
                            <div class="col-md-3 mb-3">
                                <div class="form-floating">
                                    <input type="time" id="modify-exam-end-time" class="form-control" placeholder="考试结束时间" />
                                    <label for="modify-exam-end-time">考试结束时间</label>
                                </div>
                            </div>
                        </div>
                        <!-- 允许逾期作答和随机问题顺序 -->
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <div class="form-floating">
                                    <select id="modify-allow-answer-when-expired" class="form-select" aria-label="允许逾期作答">
                                        <option value="" selected>--- 请选择 ---</option>
                                        <option value="1">允许</option>
                                        <option value="0">不允许</option>
                                    </select>
                                    <label for="modify-allow-answer-when-expired">允许逾期作答</label>
                                </div>
                            </div>
                            <div class="col-md-6 mb-3">
                                <div class="form-floating">
                                    <select id="modify-random-questions" class="form-select" aria-label="随机问题顺序">
                                        <option value="" selected>--- 请选择 ---</option>
                                        <option value="1">是</option>
                                        <option value="0">否</option>
                                    </select>
                                    <label for="modify-random-questions">随机问题顺序</label>
                                </div>
                            </div>
                        </div>
                        <!-- 导入题目文件 -->
                        <div class="col-12 mb-3">
                            <span id="modify-xlsx-file-name">请选择要导入的题目文件（csv格式）</span>
                            <br />
                            <div class="row mt-2">
                                <div class="col-md-6 mb-3">
                                    <input type="file" id="modify-xlsx-file" style="display: none" accept=".csv" />
                                    <button type="button" class="btn btn-danger btn-rounded btn-lg w-100" data-mdb-ripple-color="#ffffff" id="modify-exam-import-questions" onclick="importModifyXlsxFile()">
                                        导入题目
                                    </button>
                                </div>
                                <div class="col-md-6 mb-3">
                                    <button type="button" class="btn btn-danger btn-rounded btn-lg w-100" data-mdb-ripple-color="#ffffff" id="modify-exam-confirm" disabled onclick="modifyExam()">
                                        确定修改
                                    </button>
                                </div>
                            </div>
                            <!-- 隐藏的输入，用于存储当前修改的考试ID -->
                            <input type="hidden" id="modify-exam-id" />
                        </div>
                    </section>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- 考试成绩查看 -->
<div class="container" id="exam-scores-view" style="display: none">
    <div class="card">
        <div class="card-body">
            <div class="row">

                <div class="col-md-12 text-end mb-3">
                    <button type="button" class="btn btn-secondary btn-rounded btn-lg" onclick="returnToExamManagement()">
                        返回
                    </button>
                </div>

                <div class="col-md-4">
                    <div class="card text-center">
                        <div class="card-header">考试信息</div>
                        <div class="card-body">
                            <h5 class="card-title" id="exam-name-title">测试考试</h5>
                            <p class="card-text">
                                开始时间：<span id="exam-start-time">2024-01-01 09:00</span><br> 结束时间：
                                <span id="exam-end-time">2024-01-01 12:00</span><br> 允许逾期作答：
                                <span id="exam-allow-expired">是</span><br> 随机问题顺序：
                                <span id="exam-random-question">否</span>
                            </p>
                        </div>
                        <div class="card-footer">
                            平均分：<span id="average-score">114.514</span>
                        </div>
                    </div>
                </div>

                <div class="col-md-8">
                    <div class="table-responsive" style="box-shadow: 2px 15px -3px rgba(0,0,0,0.07), 0 10px 20px -2px rgba(0,0,0,0.04)">
                        <table class="table table-striped table-hover">
                            <thead>
                                <tr>
                                    <th scope="col">#</th>
                                    <th scope="col">学生姓名</th>
                                    <th scope="col">学号</th>
                                    <th scope="col">考试成绩</th>
                                    <th scope="col">逾期作答</th>
                                </tr>
                            </thead>
                            <tbody id="scores-table-body">
                                <!-- 动态填充成绩数据 -->
                                <!-- 示例数据 -->
                                <!--
                                    <tr>
                                        <th scope="row">1</th>
                                        <td>张三</td>
                                        <td>1001</td>
                                        <td>95</td>
                                        <td>否</td>
                                    </tr>
                                    -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>